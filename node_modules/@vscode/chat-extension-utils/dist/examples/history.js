"use strict";
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation and GitHub. All rights reserved.
 *--------------------------------------------------------------------------------------------*/
Object.defineProperty(exports, "__esModule", { value: true });
exports.MyPrompt = void 0;
const prompt_tsx_1 = require("@vscode/prompt-tsx");
const history_1 = require("../components/history");
/**
 * Including conversation history in your prompt is important as it allows the
 * user to ask followup questions to previous messages. However, you want to
 * make sure its priority is treated appropriately because history can
 * grow very large over time.
 *
 * We've found that the pattern which makes the most sense is usually to prioritize, in order:
 *
 * 1. The base prompt instructions, then
 * 1. The current user query, then
 * 1. The last couple turns of chat history, then
 * 1. Any supporting data, then
 * 1. As much of the remaining history as you can fit.
 *
 * For this reason, we split the history in two parts in the prompt, where
 * recent prompt turns are prioritized above general contextual information.
 */
class MyPrompt extends prompt_tsx_1.PromptElement {
    render() {
        return (vscpp(vscppf, null,
            vscpp(prompt_tsx_1.SystemMessage, { priority: 100 }, "Here are your base instructions. They have the highest priority because you want to make sure they're always included!"),
            vscpp(history_1.HistoryMessages, { history: this.props.history.slice(0, -2), priority: 0 }),
            vscpp(history_1.HistoryMessages, { history: this.props.history.slice(-2), priority: 80 }),
            vscpp(history_1.History, { history: this.props.history, newer: 80, older: 0, passPriority: true }),
            vscpp(prompt_tsx_1.UserMessage, { priority: 90 }, this.props.userQuery),
            vscpp(prompt_tsx_1.UserMessage, { priority: 70 }, "With a slightly lower priority, you can include some contextual data about the workspace or files here...")));
    }
}
exports.MyPrompt = MyPrompt;
